added from leiyang's windows